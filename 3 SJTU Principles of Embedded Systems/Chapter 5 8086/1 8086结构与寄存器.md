## 1. 8086概述
8086是16位的微处理器,具有16位的数据总线，20位的地址总线(寻址1MB地址空间)，时钟频率为5MHz,64KB的I/O地址空间, 8086可以和浮点运算器(协处理器)、I/O处理器等组成多处理器系统，提高数据处理能力和I/O吞吐能力.

> 1. 流水线技术

8086 指令执行采取流水线技术, (1)取指 (2)译码 (3)读取操作数(如果需要) (4)执行指令 (5)存放如果(如果必要) 如同之前介绍的流水线段, 8086通过执行单元EU负责执行指令,总线接口单元BIU负责取指、取操作数和写结果，独立地，并行地完成各自的任务, 当EU执行指令的时候, BIU就预取下一条要执行的指令。

由于流水线操作中,预取的指令可能不是马上执行,需要有一个暂时存放所预取得指令的地方: 6B的指令流队列(Instruction Stream Queue),这个队列遵循FIFO.

> 2. 存储器的分段结构

8086具有20根地址线,可以寻址1MB的内存空间,但是内部寄存器和数据总线都只有16位,即ALU提供的最大地址空间只能是64KB。 为了实现CPU对 1MB 空间的寻址，8086采取对内存储器空间分为若干逻辑段的方法。 一个实际的存储器单元地址由 十六位的段地址A与十六位的偏移地址B组成, 物理地址为 A左移四位 + B。 每个段最大为64KB, CPU中设置有专门的段寄存器用以存放逻辑段的起始地址。

> 3. 支持用于浮点运算的协处理器与多微处理器系统

8086之前的微处理器, 采用定点数据来表示浮点运算,会导致运算效率降低大约两个数量级, 8086CPU可以支持用于浮点运算的数学协处理器 8087, 此外,8086支持使用该微处理器构成一个共享总线的多微处理器系统。

## 2.1 8086的内部结构
8086内部结构主要分为两个部分, 总线接口部件BIU(Bus Interface Unit) 和 执行部件EU(Execute Unit).

1. BIU: 总线接口单元

BIU根据执行部件EU的请求，负责完成CPU与存储器和I/O设备之间的数据传送

内部构成:
1. 4个段寄存器 CS,DS,SS,ES
2. 20位的地址生成电路
3. 1个16位的指令指针寄存器IP，存放下一条要执行的指令的段内地址偏移量
4. 1个6字节(8088是4)字节的指令队列缓冲器
5. 总线控制电路

当EU取走指令后，指令流队列出现2个以上空单元时,BIU就自动执行一次取指令周期,从内存中取出后续的指令代码放入队列。 如果EU需要数据，BIU根据EU给出的地址从指定的内存单元或者外设中取出数据供EU使用, 运算结束之后, BIU负责将运算结果放入指定的内存单元或者外设中(if needed)

> 2. EU: 执行部件

EU在工作的时候从指令流队列中取指令代码, 对其译码产生完成指令所需要的控制信息, 数据在ALU中进行运算, 运算结果的特征保留在标志寄存器FLAGS.

从BIU的指令队列中取指，经过指令译码器译码后执行指令,指令执行结果或者所需的数据都由EU向BIU发出命令，对存储器或者I/O接口进行读写操作。

内部构成:
1. 1个16位的算术逻辑单元(ALU)
2. 8个16位的通用Reg
3. 1个16位的状态标志PSW(FLAGS)，一个暂存Reg
4. EU的控制电路

EU和BIU可以独立工作,BIU在保证EU与片外传送操作数的前提下，可以进行指令预取，与EU可以重叠操作，这是流水线技术的雏形。

## 2.2 8086的寄存器组
8086总共有14个16位的寄存器:
- 1. 8个通用寄存器 AX,BX,CX,DX,SP,BP,DI,SI
- 2. 4个段寄存器 CS,DS,SS,ES
- 3. 指令指针寄存器 IP
- 4. 标志位寄存器PSW

> 1. 8个通用寄存器

一. 通用数据寄存器: AX, BX, CX, DX: 一般用来存放8位或者16位操作数,大多数的算术和逻辑运算都可以使用这些寄存器,同时每个寄存器又有一些特殊的功能。

AX: Accumulator
1. 作为累加器用于乘法、除法及一些调整指令的时候，具有专门的用途
2. 在I/O指令中存放输入/输出数据

BX: Base
1. 在间接寻址和查表转换时，存放访问存储单元的偏移地址

CX: Count
1. 存放多种指令的计数值(重复次数),如串操作指令,移位指令,循环移位指令的移位次数,LOOP/LOOPD指令的循环次数等等
2. 移位和循环移位指令用CL计数，重复串操作指令用CX计数，LOOP/LOOPD指令用CX计数

DX: Data
1. 在乘法指令中用于保存乘法运算产生的乘积的高位部分
2. 在除法指令中存放被除数高位部分或者余数
3. 在I/O操作时，用于对IO端口间接寻址

二. 地址指针寄存器: BP、SP

SP: Stack Pointer
1. 堆栈指针寄存器, SP用于存放一个称为'堆栈'的存储区地栈顶位置

BP: Base Pointer
1. 基地址指针寄存器, BP常常用来存放访问内存时的基地址, 但是它通常与SS寄存器配对使用

三. 变址寄存器: SI、DI

SI: Source Index 
1. SI 用于寻址串操作指令的源数据串

DI: Destination Index
1. DI 用于寻址串操作指令的目的数据串

> 2. 段寄存器

1. CS: 代码段,是用来存储程序代码的一个存储区域，CS存储代码段起始位置的高16位,对CPU而言数据和代码的差别就在于CS:IP的指向
2. DS: 数据段，包含程序所使用的大部分数据的存储区
3. ES：附加段，为某些串操作指令存放目的操作数而附加的一个数据段
4. SS: 堆栈段, 堆栈是一个遵循LIFO原则的特殊存储区，SS与SP配合确定堆栈的入栈和出栈操作的地址,SS与BP配合，寻址堆栈段内其它数据

> 3. 指针和状态标志寄存器
指令指针寄存器IP: 16位，存放下一条要执行的指令相对CS的偏移地址, IP对程序员而言是不可见的，也就是说，IP不能作为操作数

标志寄存器FLAGS(PSW)，16位，储存状态信息

## 2.2 8086寻址
1. 立即寻址: 指令的源操作数是参加操作的一个立即数,由指令直接给出,在CPU取指令时随指令码一起取出并直接参与运算.如: MOV AX, 2233H
2. 直接寻址: 在指令中直接给出操作数的16位偏移地址，如果不显示段超越，则默认以DS为段基地址. 如 MOV AX, [1234H]. MOV AX, ES:[1234H]
3. 寄存器寻址: 指令的操作数是CPU的内部寄存器(数据寄存器,地址指针,变址寄存器,段寄存器). 如： MOV SS, AX
4. 寄存器间接寻址: 指令中指定的寄存器中不是操作数，而是操作数的偏移地址，当选用SI、DI、BX为间址寄存器的时候，默认段基址在DS，选取BP为间址寄存器，默认段基址在SS，二者都允许段超越。但是作为间址寄存器的只有这四个。如: MOV AX, [BX]. MOV AX, [BP]
5. 寄存器相对寻址: 偏移地址除了间址寄存器中的位移量外，还另外加上指令中给出的一个8/16位的地址位移量. 如: MOV AL, [BX+05]. MOV AH, 05[BX]
6. 基址-变址寻址: 这种寻址方式选取一个基址寄存器(BX/BP)和一个变址寄存器(SI/DI)内容相加形成偏移地址，如果使用BX则默认为DS，BP默认为SS，允许超越. 如: MOV AX, [BP+SI]. MOV AX, [BX+DI].
7. 基址-变址-相对寻址: MOV AX, [DI+BX+06H]
8. 隐含寻址: 有的指令的操作吗中隐含了部分操作数的地址

基址,变址都是寄存器，相对寻址是一个立即数代表的偏移量

