## 3. 计算机语言层次
一般可以把程序设计语言分成三个层次: 机器语言、汇编语言和高级语言。 有了汇编语言后，计算机对程序员来说就是一个能理解汇编语言的机器，类似的，对高级语言而言计算机就是一个可以理解高级语言的机器而和具体的机器结构无关。

## 3.1 机器语言
机器语言是用二进制代码表示的能够被计算机硬件直接识别和执行的语言, 包含一定的编码格式和构成规则，其与计算机的结构、操作系统等有关,因此在不同的计算机中，机器语言一般是不同的。

## 3.2 汇编语言
汇编语言程序采用文字符号(助记符)表示机器语言，汇编语言的程序大部分指令和机器指令一一对应，但是需要经过**汇编程序**翻译成二进制的机器语言才能在计算机上运行。

通常称汇编程序和高级语言等程序设计语言编写的程序为源程序，计算机中所有的指令助记符以及使用规则构成了汇编语言，汇编语言通常还提供有关程序装入的内存的位置的信息、程序段和数据段开始结束的信息、条件汇编、文件包含、常数定义等，表示这些信息的指令称为伪指令，伪指令没有对应的机器指令，但其为汇编程序提供信息。

## 3.3 高级语言
汇编语言仍然是一门面向计算机硬件的语言，而且不同的计算机有不同的汇编语言，其适合于编写一些对速度和代码长度要求较高的程序以及直接控制硬件的程序。

高级语言是与计算机结构无关的程序设计语言，具有更强的表达能力。其在计算机上运行有两种方法，一是通过编译之后再运行之前转化为机器语言程序，二是通过解释程序解释执行，即逐个解释并立即执行源程序。编译的方法具有较高的效率，通过使用编译的方法。

库程序中提供了一些常用的公共子程序，对静态连接库，在编译的过程会把库函数的代码变为可执行代码的一部分，例如.c文件中的#include指令就是完成这件事情的，这会导致目标代码形成之后就不可能进行版本更新，而且会有内存浪费。 动态连接库的库程序在运行时才按需下载连接，可以很好地支持OOP语言编程。

**程序的编译和执行过程**在CSAPP的一二章笔记中有详细的记录。

## 4. 数据的编码
在计算机中用编码表示的二进制数据称为机器数，其是位数固定而且数值有限的二进制代码，因此表示的数值范围有限。计算机中的机器数是一系列的离散数据，机器数分为无符号数和有符号数两种，无符号数每一位都代表数值，通常直接用它的二进制数作为机器数。

## 4.1 数制的转换
对一个n位的R进制数整数而言，其表示的值为:
$$x_0x_1x_2...x_{n-1} = x_0R^{n-1}+x_1R^{n-1}+...+x_{n-1}R^0$$
对一个n位的R进制纯小数而言:
$$x_0x_1x_2...x_{n-1} = x_0R^0+x_1R^{-1}+...+x_{n-1}R^{1(n-1)}$$
对于一般情况，我们可以拆分成两部分再分别相加。

## 4.2 无符号数的编码
定点数指小数点位置固定不变的数据，通常有两种定点数:一种是小数点在最低为数的右面，即定点整数，一种是小数点固定在最高位的后面，即纯小数，小数点前一位数据固定为0.

对于一个(n+1)位的整数,其可表示的范围: $0 \leq x \leq 2^{n+1}-1$
$$x_0x_1...x_n = x_02^n + x_12^{n-1} + ... +x_n2^{0}$$

对于一个(n+1)位的纯小数,其可表示的范围: $0 \leq x \leq 1 - 2^{-n}$
$$x_0x_1...x_n = x_12^{-1}+....+x_n2^{-n}$$

## 4.3 有符号数的编码
为了表示负数，需要在数据中增加表示正负符号位的信息。
## 4.3.1 原码
对于一个 (n+1) 位的二进制顶点整数,原码定义为:

        if x >=0 and x < 2^n:
            [x] = x
        elif -2^n < x and x <=0
            [x] = 2^n + |x|

对正数而言, 其原码就是它的二进制编码在最高位补0，而对负数而言，其原码是在二进制编码的最高位补1.

$$x = (-1)^{x_0}(x_12^{n-1}+...+x_n2^0)$$
$$-2^n + 1 \leq x \leq 2^n - 1$$

显然原码只能表示$2^{n+1}-1$个数字,因为0的编码不唯一。

对于一个 (n+1) 位的定点小数, 原码定义为:

        if x >=0 and x < 1:
            [x] = x
        elif -1 < x and x <= 0:
            [x] = 1+|x|

小数的原码和整数的补码都是一样，根据正负在最高位添加0/1。

$$x = (-1)^{x_0}(x_12^{-1}+...+x_{n-1}2^{-(n-1}x_n2^{-n})$$
$$-1+2^{-n} \leq x \leq 1-2^{-n}$$

## 4.3.2 反码
注意以下的定义+x实际上是取减掉一个无符号数的编码！

反码的最高位也是符号位,对(n+1)位的定点整数:

        if x >= 0 and x < 2^n:
            [x] = x
        elif 0 >= x and x > -2^n:
            x = 2^(n+1)-1 + x

$$x = -x_0(2^n-1) + x_12^{n-1}+...+x_{n-1}2+x_n$$
$$-2^n+1 \leq x \leq 2^n-1$$

对(n+1)位的定点小数而言:

        if x >= 0 and x < 1:
            [x] = x
        elif x<=0 and x > -1:
            [x] = 2 - 2^(-n) + x

$$x = -x_0(1-2^{-n})+x_12^{-1}+...+x_n2^{-n}$$
$$-1+2^{-n} \leq x \leq 1-2^{-n}$$

对负数而言,反码在最低位加1得到补码，反码是原码除了符号位外取反得到。

## 4.3.3 补码
补码表示法用最高位代表符号,其余各位代码代表数值,对正数而言，补码与原码反码相同，对负数而言，补码是原码除符号位外按位取反加一得到。

(n+1)位定点整数:$x_0x_1...x_n$

        if x >= 0 and x < 2^n:
            [x] = x
        elif x < 0 and x >= 2^(-n):
            [x] = 2^(n+1) + x

$$x = -x_02^n + x_12^{n-1} + ... + x_n$$
$$-2^n \leq x \leq 2^n - 1$$

注意(n+1)位的补码的数值范围正负不对称,正部小1！

对于(n+1)位的定点小数: 

        if x >= 0 and x < 1:
            [x] = x
        elif x < 0 and x >= -1:
            [x] = 2 + x 

$$x = -x_02^0 + x_12^{-1} + ... + x_n2^{-n}$$
$$-1 leq x \leq 1 - 2^{-n}$$

## 4.3.4 移码
为了便于比较数中间的大小,对(n+1)位的二进制整数,定义移码: $[x] = 2^n+x$，x是二进制编码,和补码相比，移码数值位与补码相同，但是符号位相反,也就是说1表示正，0表示负.
